import{T as x,f as b,A as z}from"./element-plus.0e1471b6.js";import{i as L}from"./resize-observer-polyfill.8deb1e21.js";import{a as C,b as h}from"./is.84ee87a3.js";import{s as E,d as B,r as k,u as s,G as S,g as W,l as I,c as V,a as y,Z as _,S as p,o as M,X as g,Y as v}from"./@vue.ae71f803.js";import{g as $}from"./@vueuse.f8c502e5.js";import{u as T}from"./vue-i18n.cb61a333.js";import"./lodash-es.2e433212.js";import"./@element-plus.681668a3.js";import"./@popperjs.36402333.js";import"./@ctrl.82a509e0.js";import"./dayjs.5bdc91a4.js";import"./async-validator.fb49d0f5.js";import"./memoize-one.4ee5c96d.js";import"./escape-html.e5dfadb9.js";import"./normalize-wheel-es.8aeb3683.js";import"./@floating-ui.6dc68714.js";import"./@intlify.372ce312.js";const N=typeof window>"u";function R(n){for(const r of n){const i=r.target.__resizeListeners__||[];i.length&&i.forEach(o=>{o()})}}function D(n,r){N||(n.__resizeListeners__||(n.__resizeListeners__=[],n.__ro__=new L(R),n.__ro__.observe(n)),n.__resizeListeners__.push(r))}function H(n,r){!n||!n.__resizeListeners__||(n.__resizeListeners__.splice(n.__resizeListeners__.indexOf(r),1),n.__resizeListeners__.length||n.__ro__.disconnect())}const U=Symbol("watermark-dom");function A(n=k(document.body)){const r=$(function(){const t=s(n);if(!t)return;const{clientHeight:e,clientWidth:l}=t;u({height:e,width:l})}),i=U.toString(),o=E();B(()=>{const t=document.getElementById(i);C(t)||(o.value=t)});const m=()=>{const t=s(o);o.value=void 0;const e=s(n);!e||(t&&e.removeChild(t),H(e,r))};function f(t){const e=document.createElement("canvas"),l=300,c=240;Object.assign(e,{width:l,height:c});const d=e.getContext("2d");return d&&(d.rotate(-20*Math.PI/120),d.font="15px Vedana",d.fillStyle="rgba(209, 213, 219, 0.5)",d.textAlign="left",d.textBaseline="middle",d.fillText(t,l/20,c)),e.toDataURL("image/png")}function u(t={}){const e=s(o);!e||(h(t.width)&&(e.style.width=`${t.width}px`),h(t.height)&&(e.style.height=`${t.height}px`),h(t.str)&&(e.style.background=`url(${f(t.str)}) left top repeat`))}const w=t=>{if(s(o))return u({str:t}),i;const e=document.createElement("div");o.value=e,e.id=i,e.style.pointerEvents="none",e.style.top="0px",e.style.left="0px",e.style.position="absolute",e.style.zIndex="100000";const l=s(n);if(!l)return i;const{clientHeight:c,clientWidth:d}=l;return u({str:t,width:d,height:c}),l.appendChild(e),i};function a(t){w(t),D(document.documentElement,r),W()&&S(()=>{m()})}return{setWatermark:a,clear:m}}const F={class:"relative w-full"},O={class:"p-5 absolute w-full"},P={class:"mt-3"},le=I({__name:"WaterMark",setup(n){const{t:r}=T(),i="Miao Miao \u{1F431}",o=k(i),m=r("page.watermark.input.placeholder"),{setWatermark:f,clear:u}=A();return(w,a)=>{const t=x,e=b,l=z;return M(),V("div",F,[y("div",O,[_(t,{modelValue:o.value,"onUpdate:modelValue":a[0]||(a[0]=c=>o.value=c),class:"max-w-sm",placeholder:s(m)},null,8,["modelValue","placeholder"]),y("div",P,[_(l,null,{default:p(()=>[_(e,{type:"primary",onClick:a[1]||(a[1]=c=>s(f)(o.value))},{default:p(()=>[g(v(s(r)("page.watermark.btn.add")),1)]),_:1}),_(e,{type:"primary",onClick:a[2]||(a[2]=c=>s(f)(i))},{default:p(()=>[g(v(s(r)("page.watermark.btn.reset")),1)]),_:1}),_(e,{type:"danger",onClick:a[3]||(a[3]=c=>s(u)())},{default:p(()=>[g(v(s(r)("page.watermark.btn.delete")),1)]),_:1})]),_:1})])])])}}});export{le as default};
